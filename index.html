<!DOCTYPE html>
<html ng-app="myApp">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="src/css/index.css">
    <script src="https://use.fontawesome.com/34f5dbde04.js"></script>
    <title>Inverted Index</title>
  </head>
  <body ng-controller="myController" ng-model="index">
     <!-- beginning of modal -->
    <div id="response-modal" class="modal fade" role="dialog">
      <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Message</h4>
          </div>
          <div class="modal-body">
            <p>{{message}}</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>

      </div>
    </div>
    <!-- end of modal -->
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <div class="navbar-header">
          <a class="navbar-brand" href="#">Inverted Index</a>
        </div>
      </div>
    </nav>
    <div class="container-fluid">
      <div class="row">
        <h3 class="text-center" style="min-height: 26px;">{{ error }}</h3>
        <div class="col-sm-4" style="margin-bottom: 10px;">
          <label class="btn btn-primary" style="margin-bottom: 10px;">Upload File
          <input class="form-control" type="file" id="fileUploaded" multiple style="display: none;">
          </label>
          <div class="input-group">
          <select ng-model="selectFile" class="form-control">
            <option value="">--Select file--</option>
            <option ng-repeat="key in uploaded" value="{{ key }}">{{ key }}</option>
          </select>
          <div class="input-group-btn">
            <button ng-click="createIndex()" class="btn btn-primary"> Create Index</button>
          </div>
          </div>
          <div class='about hidden-xs'>
            <h3>About App</h3>
            <p>
              An inverted index consists of a list of all the unique words that appear in any document, 
              and for each word, a list of the documents in which it appears.
            </p>
            <h4>Usage</h4>
            <h5>Upload</h5>
            <ul>
              <li>Upload JSON file(s)</li>
              <li>Select a file to create index for</li>
              <li>Click create index</li>
            </ul>
            <h5>Search</h5>
            <ul>
              <li>Select file(s) to search</li>
              <li>Enter search term(s)</li>
              <li>Click search</li>
            </ul>
          </div>
        </div>
        <div class="col-sm-8">
          <form ng-show="display">
            <span class="col-xs-4">
                <select ng-model="selectContent" class="form-control text-center">
                  <option value="">--Select file to search--</option>
                  <option value="all" selected>--All--</option>
                  <option ng-repeat="key in uploaded" value="{{ key }}">{{ key }}</option>
                </select>                  
              </span>
              <div class="input-group col-md-4">
                <input type="text" class="form-control" id="searchTerms" name="searhTerms" placeholder="Search for words in file..." ng-model="searchIndex" ng-show="display"/>
                <div class="input-group-btn">
                  <input type="button" id="searcher" value="search index" ng-click="search()" class="btn btn-primary"/>
                </div>
              </div>
          </form>
          <div class="searchResult text-center" ng-show="showSearch">
            <h3>Search Result</h3>
          </div>
          <div ng-repeat="(key, value) in index" class="table-container">
            <!-- title of File -->
            <h4 style="text-align: center; min-width: 100%; ">File : {{ key.replace('.json', '')}}</h4>
            <!-- Create table -->
            <table class="table table-responsive table-striped table-bordered" style="max-height: 30px; overflow-y:scroll; text-align: center;">
              <thead style="background: #337ab7; color: white">
                <tr>
                  <th style="text-align: center">Word</th>
                  <th style="text-align: center" ng-repeat="tableHead in tableHeader[key]">Doc {{tableHead + 1}}</th>            
                </tr>
              </thead>    
              <tbody>
                <tr ng-repeat="(key2, value2) in value"> 
                  <td>{{key2}}</td> 
                  <td ng-repeat="row in tableHeader[key]">
                    <span ng-if='value2.indexOf(row) >= 0'>
                      <i class="fa fa-check" aria-hidden="true"></i>
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://opensource.keycdn.com/angularjs/1.5.8/angular.min.js "></script>
    <script src="src/inverted-index.js"></script>
    <script src="src/app.js"></script>
  </body>
</html>